# 拼音搜索功能说明

## 功能概述

YTools 现已支持中文目录的拼音搜索功能，让您可以使用拼音快速找到中文命名的工作区文件夹。

## 搜索方式

### 1. 直接搜索（原有功能）
直接输入目录的完整名称或部分名称进行搜索。

**示例**：
- 目录：`项目管理`
- 搜索：`项目` 或 `管理` → ✅ 匹配

### 2. 拼音全拼搜索（新功能）
使用完整的拼音进行搜索。

**示例**：
- 目录：`项目管理`
- 拼音全拼：`xiangmuguanli`
- 搜索：
  - `xiangmu` → ✅ 匹配（前缀匹配）
  - `guanli` → ✅ 匹配（后缀匹配）
  - `muguanli` → ✅ 匹配（部分匹配）

### 3. 拼音首字母缩写搜索（新功能）
使用拼音的首字母进行快速搜索。

**示例**：
- 目录：`项目管理`
- 拼音首字母：`xmgl`
- 搜索：
  - `xmgl` → ✅ 匹配（完整匹配）
  - `xm` → ✅ 匹配（前缀匹配）
  - `gl` → ✅ 匹配（后缀匹配）

### 4. 混合搜索
支持中英文混合的目录名称。

**示例**：
- 目录：`React项目`
- 搜索：
  - `react` → ✅ 匹配（英文部分）
  - `xiangmu` → ✅ 匹配（拼音全拼）
  - `xm` → ✅ 匹配（拼音首字母）

## 搜索优先级

搜索结果按以下优先级排序：

1. **完全包含匹配**（最高优先级）
   - 直接包含搜索词
   - 拼音全拼包含搜索词
   - 拼音首字母包含搜索词

2. **模糊匹配**（当没有完全包含匹配时）
   - 最长连续匹配字符数（降序）
   - 总匹配字符数（降序）
   - 编辑距离（升序）
   - 返回得分最高的前 5 个结果

## 使用示例

### 场景 1：快速输入
- 目录：`前端开发文档`
- 搜索：`qdkfwd` → ✅ 匹配（拼音首字母）

### 场景 2：两字目录
- 目录：`长安`
- 拼音全拼：`changan`
- 拼音首字母：`ca`
- 搜索：
  - `changan` → ✅ 匹配（完整拼音）
  - `chang` → ✅ 匹配（前缀）
  - `an` → ✅ 匹配（后缀）
  - `ca` → ✅ 匹配（首字母）

### 场景 3：部分记忆
- 目录：`测试环境配置`
- 搜索：`ceshi` → ✅ 匹配（拼音全拼前缀）
- 搜索：`peizhi` → ✅ 匹配（拼音全拼后缀）

### 场景 4：模糊搜索
- 目录：`客户管理系统`
- 搜索：`khgl` → ✅ 匹配（拼音首字母部分）
- 搜索：`guanli` → ✅ 匹配（拼音全拼部分）

## 实现细节

### 使用的库
- **pinyin (0.10)**: Rust 拼音转换库

### 拼音转换规则

#### 全拼转换 (`to_pinyin_full_multi`)
1. **ASCII 字母**：保留并转小写
2. **ASCII 数字和符号**：保留原样
3. **中文字符**：转换为所有可能的拼音（支持多音字）
   - 例如："长" → ["chang", "zhang"]
   - 例如："长安" → ["changan", "zhangan"]（组合所有可能性）
4. **连接方式**：所有拼音直接连接，无分隔符

#### 首字母缩写转换 (`to_pinyin_initials_multi`)
1. **ASCII 字母**：保留并转小写
2. **ASCII 数字和符号**：忽略
3. **中文字符**：取所有可能拼音的首字母（支持多音字）
   - 例如："长" → ["c", "z"]
   - 例如："长安" → ["ca", "za"]（组合所有可能性）
4. **连接方式**：所有首字母直接连接

#### 多音字处理
- **完全支持多音字**：系统会生成所有可能的拼音组合
- **智能匹配**：只要匹配任意一种读音即可搜索到
- **性能优化**：在搜索时实时计算，无需预处理

### 性能优化
- 拼音转换在搜索时实时计算
- 采用多种匹配策略并行计算
- 模糊匹配限制返回前 5 个结果

## 注意事项

1. **大小写不敏感**：所有搜索都不区分大小写
2. **多音字处理**：使用最常见的拼音（由 pinyin crate 决定）
3. **特殊字符**：空格、下划线等在首字母缩写中被忽略
4. **搜索性能**：拼音转换会增加一定的计算开销，但对于中小规模的目录列表影响不大

## 更新日志

- **2025-01-28**: 添加拼音搜索功能
  - 支持拼音全拼搜索
  - 支持拼音首字母缩写搜索
  - 优化模糊匹配算法，同时考虑拼音匹配得分

